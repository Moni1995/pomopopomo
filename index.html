<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#D94F30">
<title>Pomodoro Planner</title>
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icons/icon-192x192.png">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Outfit:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&family=Share+Tech+Mono&family=Orbitron:wght@400;500;600;700&family=Crimson+Pro:wght@400;500;600&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div id="sync-toast" class="sync-toast"></div>

<!-- TIMER -->
<div id="page-timer" class="page active">
  <div class="page-header"><div class="page-header-left"><h1>ğŸ… Pomodoro</h1><p id="timer-date"></p></div><div style="display:flex;gap:8px;align-items:flex-start;"><button class="theme-btn user-btn" data-action="open-identity">ğŸ‘¤</button><button class="theme-btn sync-btn" data-action="cloud-sync" title="Sync data">ğŸ”„</button><button class="theme-btn" data-action="open-theme">ğŸ¨</button></div></div>
  <div class="timer-container">
    <div class="pomo-counter" id="pomo-set-counter"><div class="pomo-counter-dot current"></div><div class="pomo-counter-dot"></div><div class="pomo-counter-dot"></div><div class="pomo-counter-dot"></div></div>
    <div class="timer-ring-wrapper"><svg class="timer-ring" viewBox="0 0 200 200"><circle class="timer-ring-bg" cx="100" cy="100" r="90"/><circle class="timer-ring-progress" id="timer-progress" cx="100" cy="100" r="90" stroke-dasharray="565.49" stroke-dashoffset="0"/></svg><div class="timer-display"><div class="timer-time" id="timer-time">25:00</div><div class="timer-label" id="timer-mode-label">FOCUS</div></div></div>
    <div class="timer-task-display"><div class="timer-task-name" id="timer-task-name">Select a task</div><div class="timer-task-sub" id="timer-task-sub">Choose from Today list</div></div>
    <div class="timer-controls">
      <button class="timer-btn-sec" id="btn-void" style="display:none;"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
      <button class="timer-btn-main start" id="btn-start"><svg width="28" height="28" viewBox="0 0 24 24" fill="white"><polygon points="5,3 19,12 5,21"/></svg></button>
      <button class="timer-btn-sec" id="btn-skip" style="display:none;"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5,4 15,12 5,20"/><line x1="19" y1="5" x2="19" y2="19"/></svg></button>
    </div>
    <div class="interrupt-row" id="interrupt-row" style="display:none;">
      <button class="interrupt-btn" id="btn-int-int"><span style="color:var(--amber);font-weight:700;">Ê¼</span> Internal</button>
      <button class="interrupt-btn" id="btn-int-ext"><span style="color:var(--void-red);font-weight:700;">â€“</span> External</button>
    </div>
  </div>
  <div class="void-banner" id="void-banner">âš ï¸ Pomodoro voided.</div>
  <div class="rule-card" id="timer-rule"><p><strong>Rule:</strong> A Pomodoro is indivisible. If interrupted, void and restart.</p></div>
  <div class="task-select-area"><div class="task-select-card"><div class="section-subtitle">Today's Tasks</div><div id="timer-task-list"></div><div class="empty-state" id="timer-empty" style="padding:20px;"><p>No tasks yet.</p></div></div></div>
</div>

<!-- TODAY -->
<div id="page-today" class="page">
  <div class="page-header"><div class="page-header-left"><h1>To Do Today</h1><p id="today-date"></p></div><div style="display:flex;gap:8px;align-items:flex-start;"><button class="theme-btn user-btn" data-action="open-identity">ğŸ‘¤</button><button class="theme-btn sync-btn" data-action="cloud-sync" title="Sync data">ğŸ”„</button><button class="theme-btn" data-action="open-theme">ğŸ¨</button></div></div>
  <div class="section">
    <div class="legend">
      <div class="legend-item"><div class="sq" style="width:12px;height:12px;cursor:default;"></div> 1st â–¡</div>
      <div class="legend-item"><div class="ci" style="width:12px;height:12px;cursor:default;"></div> 2nd â—‹</div>
      <div class="legend-item"><svg width="12" height="11"><polygon points="6,0 12,11 0,11" fill="var(--purple)" opacity=".7"/></svg> 3rd â–³</div>
    </div>
    <div class="input-row">
      <input type="text" id="today-task-input" placeholder="Add a taskâ€¦">
      <input type="number" id="today-est-input" placeholder="ğŸ…" min="1" max="20" style="width:60px;">
      <button class="btn btn-primary" id="btn-add-today">Add</button>
    </div>
    <button class="btn btn-ghost btn-sm" id="btn-pick-inv" style="width:100%;margin-bottom:16px;">â†“ Pick from Inventory</button>
  </div>
  <div class="section" style="padding-top:0;"><div class="section-subtitle">Planned Tasks</div><div id="today-tasks"></div><div class="empty-state" id="today-empty"><p>Plan your day.</p></div></div>
  <div class="section"><div class="section-subtitle">Unplanned & Urgent</div><div id="unplanned-tasks"></div><div class="input-row"><input type="text" id="unplanned-input" placeholder="Unplanned taskâ€¦"><button class="btn btn-ghost btn-sm" id="btn-add-unplanned">Add</button></div></div>
  <div class="section"><div style="display:flex;gap:8px;"><button class="btn btn-ghost btn-sm" id="btn-end-day" style="flex:1;">ğŸ“Š End Day</button><button class="btn btn-ghost btn-sm" id="btn-clear-day" style="flex:1;">ğŸ—‘ Clear</button></div></div>
</div>

<!-- INVENTORY -->
<div id="page-inventory" class="page">
  <div class="page-header"><div class="page-header-left"><h1>Activity Inventory</h1><p>Master backlog</p></div><div style="display:flex;gap:8px;align-items:flex-start;"><button class="theme-btn user-btn" data-action="open-identity">ğŸ‘¤</button><button class="theme-btn sync-btn" data-action="cloud-sync" title="Sync data">ğŸ”„</button><button class="theme-btn" data-action="open-theme">ğŸ¨</button></div></div>
  <div class="section">
    <div class="input-row">
      <input type="text" id="inv-task-input" placeholder="Add activityâ€¦">
      <button class="btn btn-primary" id="btn-add-inv">Add</button>
    </div>
    <p style="font-size:11px;color:var(--text3);margin-top:-6px;margin-bottom:12px;">Add tasks here. Estimate Pomodoros when you move them to Today.</p>
  </div>
  <div class="section" style="padding-top:0;"><div id="inventory-tasks"></div><div class="empty-state" id="inv-empty"><p>Inventory empty.</p></div></div>
  <div class="section" style="padding-top:0;">
    <div class="collapse-header" data-action="toggle-collapse" data-target="completed-section"><span>Completed (<span id="completed-count">0</span>)</span><span class="collapse-chevron" id="completed-chevron">â–¸</span></div>
    <div id="completed-section" class="collapse-body"><div id="completed-tasks"></div><div class="empty-state" id="completed-empty" style="padding:12px;"><p>No completed tasks.</p></div></div>
  </div>
  <div class="section" style="padding-top:0;">
    <div class="collapse-header" data-action="toggle-collapse" data-target="trash-section"><span>Trash (<span id="trash-count">0</span>)</span><span class="collapse-chevron" id="trash-chevron">â–¸</span></div>
    <div id="trash-section" class="collapse-body"><div id="trash-tasks"></div><div class="empty-state" id="trash-empty" style="padding:12px;"><p>Trash is empty.</p></div><button class="btn btn-ghost btn-sm" id="btn-empty-trash" style="width:100%;margin-top:8px;display:none;">Empty Trash</button></div>
  </div>
</div>

<!-- RECORDS -->
<div id="page-records" class="page">
  <div class="page-header"><div class="page-header-left"><h1>Records</h1><p>Track & visualize</p></div><div style="display:flex;gap:8px;align-items:flex-start;"><button class="theme-btn user-btn" data-action="open-identity">ğŸ‘¤</button><button class="theme-btn sync-btn" data-action="cloud-sync" title="Sync data">ğŸ”„</button><button class="theme-btn" data-action="open-theme">ğŸ¨</button></div></div>
  <div class="stat-grid">
    <div class="stat-card"><div class="stat-value" id="stat-today">0</div><div class="stat-label">Today</div></div>
    <div class="stat-card"><div class="stat-value" id="stat-total">0</div><div class="stat-label">All Time</div></div>
    <div class="stat-card"><div class="stat-value" id="stat-avg">0</div><div class="stat-label">Daily Avg</div></div>
    <div class="stat-card"><div class="stat-value" id="stat-streak">0</div><div class="stat-label">Streak</div></div>
  </div>
  <div class="chart-container" id="chart-container">
    <h3>ğŸ“Š Daily Pomodoros</h3>
    <canvas class="chart-canvas" id="chart-canvas"></canvas>
    <div class="chart-empty" id="chart-empty" style="display:none;">Complete some days to see your graph.</div>
  </div>
  <div class="section"><div class="section-subtitle">Daily Records</div><div id="records-list"></div><div class="empty-state" id="records-empty"><p>No records yet.</p></div></div>
  <div class="section">
    <button class="btn btn-ghost btn-sm" id="btn-export" style="width:100%;">ğŸ“¤ Export JSON</button>
    <button class="btn btn-ghost btn-sm" id="btn-import" style="width:100%;margin-top:8px;">ğŸ“¥ Import JSON</button>
    <input type="file" id="file-import" accept=".json">
    <button class="btn btn-ghost btn-sm" id="btn-reset" style="width:100%;margin-top:8px;">ğŸ—‘ Reset All</button>
  </div>
</div>

<!-- RULES -->
<div id="page-guide" class="page">
  <div class="page-header"><div class="page-header-left"><h1>Rules</h1><p>The method</p></div><div style="display:flex;gap:8px;align-items:flex-start;"><button class="theme-btn user-btn" data-action="open-identity">ğŸ‘¤</button><button class="theme-btn sync-btn" data-action="cloud-sync" title="Sync data">ğŸ”„</button><button class="theme-btn" data-action="open-theme">ğŸ¨</button></div></div>
  <div class="section">
    <div class="card"><h3 style="color:var(--accent-glow);font-size:16px;margin-bottom:8px;">The 5 Stages</h3><p style="font-size:13px;color:var(--text2);line-height:1.7;"><strong style="color:var(--text1);">1. Planning</strong> â€” Pick tasks, estimate.<br><br><strong style="color:var(--text1);">2. Tracking</strong> â€” Mark âœ• and interruptions.<br><br><strong style="color:var(--text1);">3. Recording</strong> â€” Save end-of-day.<br><br><strong style="color:var(--text1);">4. Processing</strong> â€” Compare est. vs actual.<br><br><strong style="color:var(--text1);">5. Visualizing</strong> â€” Find patterns.</p></div>
    <div class="card"><h3 style="color:var(--accent-glow);font-size:16px;margin-bottom:8px;">Core Rules</h3><p style="font-size:13px;color:var(--text2);line-height:1.7;"><strong style="color:var(--text1);">Indivisible.</strong> 25 min.<br><br><strong style="color:var(--text1);">Must ring.</strong> Stop early = void.<br><br><strong style="color:var(--text1);">Done early?</strong> Review until ring.<br><br><strong style="color:var(--text1);">After 4,</strong> long break.<br><br><strong style="color:var(--text1);">>7?</strong> Break down. <strong style="color:var(--text1);"><1?</strong> Combine.</p></div>
    <div class="card"><h3 style="color:var(--accent-glow);font-size:16px;margin-bottom:8px;">â–¡ â—‹ â–³ Estimation</h3><p style="font-size:13px;color:var(--text2);line-height:1.7;"><strong style="color:var(--accent-glow);">â–¡ First</strong> â€” Initial estimate. Click squares to fill.<br><br><strong style="color:var(--blue);">â—‹ Second</strong> â€” Re-estimate after learning more.<br><br><strong style="color:var(--purple);">â–³ Third</strong> â€” Final re-estimate.</p></div>
  </div>
</div>

<!-- MODALS -->
<div class="modal-overlay" id="modal-inv-picker"><div class="modal"><h2>Pick from Inventory</h2><div id="inv-picker-list"></div><div id="picker-est-row" style="display:none;margin-top:12px;"><div style="font-size:13px;color:var(--text2);margin-bottom:8px;">Initial estimate (Pomodoros):</div><div class="input-row"><input type="number" id="picker-est-input" placeholder="ğŸ…" min="1" max="20" style="width:70px;"><button class="btn btn-primary" id="btn-confirm-pick">Add to Today</button></div></div><div class="modal-actions"><button class="btn btn-ghost" id="btn-close-picker">Cancel</button></div></div></div>
<div class="modal-overlay" id="modal-theme"><div class="modal"><h2>ğŸ¨ Theme</h2><div class="section-subtitle">Style</div><div class="theme-grid" id="theme-grid"></div><div class="section-subtitle">Mode</div><div class="mode-toggle"><button class="mode-toggle-btn" data-mode="dark" id="mode-dark">ğŸŒ™ Dark</button><button class="mode-toggle-btn" data-mode="light" id="mode-light">â˜€ï¸ Light</button></div><div class="modal-actions"><button class="btn btn-ghost" id="btn-close-theme">Done</button></div></div></div>

<!-- NAV -->
<nav class="bottom-nav">
  <button class="nav-btn active" data-page="page-timer"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Timer</button>
  <button class="nav-btn" data-page="page-today"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/></svg>Today</button>
  <button class="nav-btn" data-page="page-inventory"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>Inventory</button>
  <button class="nav-btn" data-page="page-records"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10"/><path d="M12 20V4"/><path d="M6 20v-6"/></svg>Records</button>
  <button class="nav-btn" data-page="page-guide"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>Rules</button>
</nav>

<script type="module" src="js/app.js"></script>
</body>
</html>
